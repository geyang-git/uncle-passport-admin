import{i as e,e as t,d as a}from"./index-e0fdaf07.js";import"./vue-echarts-85a407f1.js";import{a as r,b as l}from"./element-plus-04192b69.js";import{u as o}from"./index-69fc4246.js";import{v as s}from"./@vue.runtime-dom-c19fd55a.js";import"./store-96e17a43.js";import{S as i}from"./@element-plus.icons-vue-32670eb7.js";import{d as n,y as d,e as p,R as u,Y as c,K as m,o as f,c as b,a as v,I as h,J as j,N as y,b as g,F as x,V as k,M as _,al as w,ak as C,q as z,z as I}from"./@vue.runtime-core-4f5b9f62.js";import{e as W,u as q}from"./@vue.reactivity-bec702f3.js";import{o as N,L as T}from"./@vue.shared-5670d8a7.js";import{_ as F}from"./_plugin-vue_export-helper-c4cb8a60.js";import{q as R}from"./lodash-es-a085e596.js";import"./axios-966d6f38.js";import"./nprogress-6d1393d1.js";import"./vue-router-18ffceba.js";import"./pinia-dbeeb1e2.js";import"./vue-demi-5b9a0fa5.js";import"./@vueuse.core-d0bf94bd.js";import"./@vueuse.shared-3f1de09b.js";import"./vue-1d48ca3b.js";import"./mockjs-93ca2bc8.js";import"./mitt-dab1f1cb.js";import"./@popperjs.core-040feab9.js";import"./@ctrl.tinycolor-84ad98d6.js";import"./dayjs-dd470533.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui.dom-9d85c32a.js";import"./@floating-ui.core-c56fb7e8.js";import"./resize-detector-94afada7.js";import"./echarts-33de40b3.js";import"./tslib-ed971494.js";import"./zrender-d158d5d4.js";const E={class:"dict-group"},G={class:"head"},M=(e=>(w("data-v-294b49d1"),e=e(),C(),e))((()=>v("span",null,"类型",-1))),K={class:"list"},S=["onClick","onContextmenu"],U=n({name:"undefined"}),A=F(n({...U,setup(a){const{service:n}=o(),w=e.exports.useForm(),C=d("dict"),z=W(""),I=W([]),F=W(!1),R=d("viewGroup");async function U(){F.value=!0,await n.dict.type.list().then((e=>{I.value=e,z.value||A(e[0])})),F.value=!1}function A(e){z.value=null==e?void 0:e.id,C.setGroup(e),C.refresh({typeId:z.value,page:1}),R.checkExpand(!1)}function J(e){var t;null==(t=w.value)||t.open({title:e?"编辑类型":"添加类型",width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}],form:{...e},on:{submit(t,{close:a,done:l}){n.dict.type[e?"update":"add"](t).then((()=>{r.success("保存成功"),a(),U()})).catch((e=>{r.error(e.message),l()}))}}})}return p((()=>{U()})),(a,o)=>{const d=u("el-button"),p=u("el-icon"),C=u("el-empty"),W=u("el-scrollbar"),R=u("cl-form"),L=c("permission"),O=c("loading");return m((f(),b("div",E,[v("div",G,[M,m((f(),h(d,{type:"success",bg:"",size:"small",onClick:o[0]||(o[0]=e=>J())},{default:j((()=>[y("添加")])),_:1})),[[L,q(n).dict.type.permission.add]])]),v("div",K,[g(W,null,{default:j((()=>[v("ul",null,[(f(!0),b(x,null,k(I.value,((a,o)=>(f(),b("li",{key:o,class:N(["item",{"is-active":z.value==a.id}]),onClick:e=>A(a),onContextmenu:o=>{!function(a,o){e.exports.ContextMenu.open(a,{hover:{target:"item"},list:[{label:"编辑",hidden:!t(n.dict.type.permission.update),callback(e){e(),J(o)}},{label:"删除",hidden:!t(n.dict.type.permission.delete),callback(e){e(),l.confirm("是否要删除该类型？","提示",{type:"warning"}).then((()=>{n.dict.type.delete({ids:[o.id]}).then((async()=>{r.success("删除成功"),await U(),z.value==o.id&&A(I.value[0])})).catch((e=>{r.error(e.message)}))})).catch((()=>null))}}]})}(o,a)}},[v("span",null,T(a.name)+" - "+T(a.key),1),m(g(p,null,{default:j((()=>[g(q(i))])),_:2},1536),[[s,z.value==a.id]])],42,S)))),128)),0==I.value.length?(f(),h(C,{key:0,"image-size":80})):_("",!0)])])),_:1})]),g(R,{ref_key:"Form",ref:w},null,512)])),[[O,F.value]])}}}),[["__scopeId","data-v-294b49d1"]]),J=n({name:"dict-list"}),L=n({...J,setup(t){const{service:r}=o(),l=W(),s=z((()=>l.value?`字典列表（${l.value.name}）`:"字典列表")),i=e.exports.useUpsert({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上级节点",prop:"parentId",component:{name:"el-tree-select",props:{data:z((()=>{var e;const t=R(null==(e=n.value)?void 0:e.data);return function e(t,a){var r;t.id&&t.id==(null==(r=i.value)?void 0:r.getForm("id"))&&(a=!0),a&&(t.disabled=!0),t.children&&t.children.forEach((t=>{e(t,a)}))}({children:t},!1),t})),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(e,{next:t}){t({...e,typeId:l.value.id})}}),n=e.exports.useTable({contextMenu:["refresh",e=>{var t;return{label:"新增",hidden:!(null==(t=r.dict.info._permission)?void 0:t.add),callback(t){b(e),t()}}},"edit","delete","order-asc","order-desc"],columns:[{label:"名称",prop:"name",align:"left",minWidth:200},{label:"排序",prop:"orderNum",sortable:"custom",width:100},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",sortable:"custom",minWidth:160},{label:"更新时间",prop:"updateTime",sortable:"custom",minWidth:160},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),d=e.exports.useCrud({service:r.dict.info,onRefresh(e,{render:t}){var o;r.dict.info.list({typeId:null==(o=l.value)?void 0:o.id,...e,page:void 0,size:void 0}).then((e=>{t(a(e))}))}});function p(e,t){var a;(null==t?void 0:t.property)&&e.children&&(null==(a=n.value)||a.toggleRowExpansion(e))}function b(e){var t;null==(t=d.value)||t.rowAppend({parentId:e.id,orderNum:1})}return I("dict",{group:l,refresh:function(e){var t;null==(t=d.value)||t.refresh(e)},setGroup:function(e){l.value=e}}),(e,t)=>{const a=u("cl-refresh-btn"),o=u("cl-add-btn"),v=u("cl-flex1"),x=u("cl-search-key"),k=u("el-row"),_=u("el-button"),w=u("cl-table"),C=u("cl-upsert"),z=u("cl-crud"),I=u("cl-view-group"),W=c("permission");return f(),h(I,{title:q(s)},{left:j((()=>[g(A)])),right:j((()=>[g(z,{ref_key:"Crud",ref:d},{default:j((()=>[g(k,null,{default:j((()=>[g(a),g(o,{disabled:!l.value},null,8,["disabled"]),g(v),g(x)])),_:1}),g(k,null,{default:j((()=>[g(w,{ref_key:"Table",ref:n,"default-sort":{prop:"orderNum",order:"ascending"},"row-key":"id",onRowClick:p},{"slot-btn":j((({scope:e})=>[m((f(),h(_,{text:"",bg:"",type:"success",onClick:t=>b(e.row)},{default:j((()=>[y("新增")])),_:2},1032,["onClick"])),[[W,q(r).dict.info.permission.add]])])),_:1},512)])),_:1}),g(k,null,{default:j((()=>[g(v)])),_:1}),g(C,{ref_key:"Upsert",ref:i},null,512)])),_:1},512)])),_:1},8,["title"])}}});export{L as default};
